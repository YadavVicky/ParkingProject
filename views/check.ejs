<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <title>Check Here</title>
    <style>
        section{
            width: 100%;
            margin: 0 30%;
        }
        p {
  display: inline;
  font-size: 40px;
  margin-top: 0px;
}
    </style>
</head>
<body>
    <section>
        <h1>Parking name:- <%= name %></h1>
        <h1>Check the Car Status here</h1>
        <form action="/check/<%= id %>/admin/check" method="GET">
            <input type="text" name="vNumber" placeholder="Enter car value">
            <input type="hidden" name="name" value=<%= name %>>
            <button type="submit">Check</button>
        </form>
        <div>
            <% if(message){ %>
            <h1 class="display-4" style="color: chartreuse;"><%= message %></h1>
            <div>
                <p>For Vehicle No:- <%= number %></p>
            </div>
            <p>The time will start in:-</p>
            <p id="days"></p>
            <p id="hours"></p>
            <p id="mins"></p>
            <p id="secs"></p>
            <h2 id="end"></h2>

            <script> const timeIn = <%- JSON.stringify(timeIn) %> </script>

            <script>
                console.log(timeIn)
                var myfunc = setInterval(function() {
                    var countDownDate = new Date(timeIn).getTime();
                    var now = new Date().getTime();
                    var timeleft = countDownDate - now;
                        
                    // Calculating the days, hours, minutes and seconds left
                    var days = Math.floor(timeleft / (1000 * 60 * 60 * 24));
                    var hours = Math.floor((timeleft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    var minutes = Math.floor((timeleft % (1000 * 60 * 60)) / (1000 * 60));
                    var seconds = Math.floor((timeleft % (1000 * 60)) / 1000);
                        
                    // Result is output to the specific element
                    document.getElementById("days").innerHTML = days + "d "
                    document.getElementById("hours").innerHTML = hours + "h " 
                    document.getElementById("mins").innerHTML = minutes + "m " 
                    document.getElementById("secs").innerHTML = seconds + "s " 
                        
                    // Display the message when countdown is over
                    if (timeleft < 0) {
                        clearInterval(myfunc);
                        document.getElementById("days").innerHTML = ""
                        document.getElementById("hours").innerHTML = "" 
                        document.getElementById("mins").innerHTML = ""
                        document.getElementById("secs").innerHTML = ""
                        document.getElementById("end").innerHTML = "And Good To Go!!";
                    }
                    }, 1000);
            </script>
            <% } %>
        </div>
        <%if(nota){%>
        <div>
            <script> const timeIn = <%- JSON.stringify(timeIn) %> </script>
            <h1 class="display-4" style="color: red;"><%= nota %></h1>
            <form action="/check/<%= id %>/admin/offlinebooking" method="get">
                <input type="hidden" name="name" value="<%= name %>">
                <input type="hidden" name="vNumber" value="<%= number %>">
                <input type="hidden" name="timeIn" value="<%= timeIn %>">
                <button class="btn btn-outline-primary">Check Offline Booking</button>
                </form>
            </div>
            <%}%>
    </section>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>
</html>